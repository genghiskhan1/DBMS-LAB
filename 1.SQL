DROP TABLE ASSIGNED_TO;
DROP TABLE PROJECT;
DROP TABLE EMPLOYEE;

CREATE TABLE EMPLOYEE (
SSN NUMBER(10) PRIMARY KEY,
NAME VARCHAR(10) NOT NULL,
DEPTNO NUMBER(10) NOT NULL
);

INSERT INTO EMPLOYEE VALUES(1,'RAM',19);
INSERT INTO EMPLOYEE VALUES(2,'GARAM',20);
INSERT INTO EMPLOYEE VALUES(3,'NARAM',21);
INSERT INTO EMPLOYEE VALUES(4,'SHARAM',22);

CREATE TABLE PROJECT (
PROJECTNO NUMBER(10) PRIMARY KEY,
PROJECTAREA VARCHAR(20) NOT NULL
);

INSERT INTO PROJECT VALUES(10,'DATABASE');
INSERT INTO PROJECT VALUES(11,'TESTING');

CREATE TABLE ASSIGNED_TO (
USN NUMBER(10) NOT NULL,
PROJECTNO NUMBER(10) NOT NULL,
FOREIGN KEY (USN) REFERENCES EMPLOYEE (SSN) ON DELETE CASCADE,
FOREIGN KEY (PROJECTNO) REFERENCES PROJECT (PROJECTNO) ON DELETE CASCADE,
PRIMARY KEY(USN,PROJECTNO)
);

INSERT INTO ASSIGNED_TO VALUES(1,10);
INSERT INTO ASSIGNED_TO VALUES(2,11);
INSERT INTO ASSIGNED_TO VALUES(3,10);
INSERT INTO ASSIGNED_TO VALUES(4,11);

SELECT *FROM EMPLOYEE;
SELECT *FROM PROJECT;
SELECT *FROM ASSIGNED_TO;

SELECT EMPLOYEE.SSN
FROM EMPLOYEE,PROJECT,ASSIGNED_TO
WHERE EMPLOYEE.SSN=ASSIGNED_TO.USN AND
ASSIGNED_TO.PROJECTNO=PROJECT.PROJECTNO AND
PROJECT.PROJECTAREA='DATABASE';

SELECT DEPTNO,COUNT(SSN)
FROM EMPLOYEE
GROUP BY DEPTNO;

UPDATE ASSIGNED_TO
SET PROJECTNO=11
WHERE USN=1;

SELECT *FROM EMPLOYEE;
SELECT *FROM ASSIGNED_TO;
SELECT *FROM PROJECT;

SELECT EMPLOYEE.NAME
FROM EMPLOYEE,PROJECT,ASSIGNED_TO
WHERE EMPLOYEE.SSN=ASSIGNED_TO.USN AND
ASSIGNED_TO.PROJECTNO=PROJECT.PROJECTNO AND
PROJECT.PROJECTAREA='TESTING';

SELECT PROJECT.PROJECTAREA,COUNT(EMPLOYEE.SSN)
FROM PROJECT,EMPLOYEE,ASSIGNED_TO
WHERE EMPLOYEE.SSN=ASSIGNED_TO.USN AND
ASSIGNED_TO.PROJECTNO=PROJECT.PROJECTNO 
GROUP BY PROJECT.PROJECTAREA;