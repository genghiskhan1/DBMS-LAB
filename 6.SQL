SET SERVEROUTPUT ON

DROP TABLE ACCOUNT;
DROP TABLE BRANCH;
DROP TABLE CUSTOMER;

CREATE TABLE BRANCH (
CODE VARCHAR2(10) PRIMARY KEY,
NAME VARCHAR(10) NOT NULL,
ASSETS NUMBER(10) NOT NULL
);

INSERT INTO BRANCH VALUES('B1','MSR','10000');
INSERT INTO BRANCH VALUES('B2','RNR','20000');
INSERT INTO BRANCH VALUES('B3','SMR','15000');
INSERT INTO BRANCH VALUES('B4','SKR','25000');

CREATE TABLE CUSTOMER (
SSN NUMBER(10) PRIMARY KEY,
NAME VARCHAR(10) NOT NULL,
PLACE VARCHAR(10) NOT NULL
);

INSERT INTO CUSTOMER VALUES(1,'RAM','BNG');
INSERT INTO CUSTOMER VALUES(2,'ASHA','MNG');
INSERT INTO CUSTOMER VALUES(3,'USHA','MYS');
INSERT INTO CUSTOMER VALUES(4,'SRI','DEL');

CREATE TABLE ACCOUNT (
ACCNO VARCHAR2(10) NOT NULL,
SSN NUMBER(10) NOT NULL,
CODE VARCHAR2(10) NOT NULL,
BALANCE NUMBER(10) NOT NULL,
FOREIGN KEY (CODE) REFERENCES BRANCH (CODE) ON DELETE CASCADE,
FOREIGN KEY (SSN) REFERENCES CUSTOMER (SSN) ON DELETE CASCADE,
PRIMARY KEY(ACCNO,CODE,SSN)
);

INSERT INTO ACCOUNT VALUES('A1',1,'B1',100000);
INSERT INTO ACCOUNT VALUES('A2',1,'B1',200000);
INSERT INTO ACCOUNT VALUES('A3',2,'B2',100000);
INSERT INTO ACCOUNT VALUES('A4',3,'B2',100000);
INSERT INTO ACCOUNT VALUES('A5',3,'B2',100000);
INSERT INTO ACCOUNT VALUES('A6',3,'B2',100000);
INSERT INTO ACCOUNT VALUES('A7',4,'B2',200000);

DESC BRANCH;
DESC CUSTOMER;
DESC ACCOUNT;

SELECT *FROM BRANCH;
SELECT *FROM CUSTOMER;
SELECT *FROM ACCOUNT;

DECLARE
CURSOR CC IS
SELECT *FROM BRANCH;
V_CC CC%ROWTYPE;

BEGIN
OPEN CC;
LOOP
FETCH CC INTO V_CC;
EXIT WHEN CC%NOTFOUND;

DBMS_OUTPUT.PUT_LINE('CODE '||V_CC.CODE||' NAME '||V_CC.NAME||' ASSETS '||V_CC.ASSETS);
END LOOP;
CLOSE CC;
END;
/

DECLARE 
CURSOR CC1 IS
SELECT *FROM CUSTOMER;
V_CC1 CC1%ROWTYPE;

BEGIN 
OPEN CC1;
LOOP
FETCH CC1 INTO V_CC1;
EXIT WHEN CC1%NOTFOUND;

DBMS_OUTPUT.PUT_LINE('SSN '||V_CC1.SSN||' NAME '||V_CC1.NAME||' PLACE '||V_CC1.PLACE);
END LOOP;
CLOSE CC1;
END;
/

DECLARE 
CURSOR CC2 IS
SELECT *FROM ACCOUNT;
V_CC2 CC2%ROWTYPE;

BEGIN
OPEN CC2;
LOOP
FETCH CC2 INTO V_CC2;
EXIT WHEN CC2%NOTFOUND;

DBMS_OUTPUT.PUT_LINE('ACCNO '||V_CC2.ACCNO||' SSN '||V_CC2.SSN||' CODE '||V_CC2.CODE||' BALANCE '||V_CC2.BALANCE);
END LOOP;
CLOSE CC2;
END;
/

BEGIN
UPDATE ACCOUNT
SET BALANCE=BALANCE+(BALANCE*0.1)
WHERE SSN=1;
COMMIT;
END;
/

SELECT *FROM ACCOUNT;