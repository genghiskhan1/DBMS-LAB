SET SERVEROUTPUT ON

DROP TABLE SUPPLY;
DROP TABLE SUPPLIER;
DROP TABLE PART;

CREATE TABLE PART (
PNO VARCHAR(10) PRIMARY KEY,
PNAME VARCHAR(10) NOT NULL,
COLOUR VARCHAR(10) NOT NULL
);

INSERT INTO PART VALUES('P231','BOLT','BLACK');
INSERT INTO PART VALUES('P234','SCREW','BROWN');

CREATE TABLE SUPPLIER (
SNO NUMBER(10) PRIMARY KEY,
SNAME VARCHAR(10) NOT NULL,
ADDRESS VARCHAR(10) NOT NULL
);

INSERT INTO SUPPLIER VALUES(1,'RAM','MYSORE');
INSERT INTO SUPPLIER VALUES(2,'GARAM','BANGALORE');

CREATE TABLE SUPPLY (
PNO VARCHAR(10) NOT NULL,
SNO NUMBER(10) NOT NULL,
FOREIGN KEY (PNO) REFERENCES PART (PNO) ON DELETE CASCADE,
FOREIGN KEY (SNO) REFERENCES SUPPLIER (SNO) ON DELETE CASCADE,
PRIMARY KEY(PNO,SNO)
);

INSERT INTO SUPPLY VALUES('P231',1);
INSERT INTO SUPPLY VALUES('P234',1);
INSERT INTO SUPPLY VALUES('P234',2);

DESC PART;
DESC SUPPLIER;
DESC SUPPLY;

SELECT *FROM PART;
SELECT *FROM SUPPLIER;
SELECT *FROM SUPPLY;

DECLARE
CURSOR CURR IS
SELECT PART.PNO,PART.PNAME,SUPPLIER.SNAME,SUPPLIER.ADDRESS
FROM PART,SUPPLIER,SUPPLY
WHERE SUPPLIER.SNO=SUPPLY.SNO AND
SUPPLY.PNO=PART.PNO AND
PART.PNO='P234';

TEMP CURR%ROWTYPE;

BEGIN
OPEN CURR;
LOOP
FETCH CURR INTO TEMP;
EXIT WHEN CURR%NOTFOUND;

DBMS_OUTPUT.PUT_LINE('PART NUMBER:      '||TEMP.PNO);
DBMS_OUTPUT.PUT_LINE('PART NAME:        '||TEMP.PNAME);
DBMS_OUTPUT.PUT_LINE('SUPPLIER NAME:    '||TEMP.SNAME);
DBMS_OUTPUT.PUT_LINE('SUPPLIER ADDRESS: '||TEMP.ADDRESS);

END LOOP;
DBMS_OUTPUT.PUT_LINE('NUMBER OF ENTRIES SELECTED: '||CURR%ROWCOUNT);
END;
/