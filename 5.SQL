DROP TABLE BORROW;
DROP TABLE BOOK;
DROP TABLE STUDENT;

CREATE TABLE BOOK (
ISBN NUMBER(10) PRIMARY KEY,
TITLE VARCHAR(10) NOT NULL,
AUTHOR VARCHAR(10) NOT NULL,
PUBLISHER VARCHAR(10) NOT NULL
);

INSERT INTO BOOK VALUES(120,'DATABASE','TATA','HERO');
INSERT INTO BOOK VALUES(121,'MINING','BATA','HEROES');
INSERT INTO BOOK VALUES(122,'STRUCTURES','MALATA','HEROINE');
INSERT INTO BOOK VALUES(123,'TESTING','BURATA','SHERO');

CREATE TABLE STUDENT (
USN NUMBER(10) PRIMARY KEY,
NAME VARCHAR(10) NOT NULL,
SEM NUMBER(10) NOT NULL,
DEPTNO NUMBER(10) NOT NULL
);

INSERT INTO STUDENT VALUES(1,'ROSE',5,10);
INSERT INTO STUDENT VALUES(2,'AROSE',6,11);
INSERT INTO STUDENT VALUES(3,'BROSE',5,10);
INSERT INTO STUDENT VALUES(4,'CROSE',6,11);
INSERT INTO STUDENT VALUES(5,'DROSE',5,10);
INSERT INTO STUDENT VALUES(6,'EROSE',6,11);

CREATE TABLE BORROW (
ISBN NUMBER(10) NOT NULL,
USN NUMBER(10) NOT NULL,
DAY DATE,
FOREIGN KEY (ISBN) REFERENCES BOOK (ISBN) ON DELETE CASCADE,
FOREIGN KEY (USN) REFERENCES STUDENT (USN) ON DELETE CASCADE,
PRIMARY KEY(ISBN,USN)
);

INSERT INTO BORROW VALUES(120,1,'12-JAN-2015');
INSERT INTO BORROW VALUES(121,2,'12-FEB-2015');
INSERT INTO BORROW VALUES(122,5,'12-MAR-2015');
INSERT INTO BORROW VALUES(123,3,'12-APR-2015');
INSERT INTO BORROW VALUES(120,4,'12-MAY-2015');
INSERT INTO BORROW VALUES(123,1,'12-JUN-2015');
INSERT INTO BORROW VALUES(122,6,'12-JUL-2015');
INSERT INTO BORROW VALUES(120,5,'12-AUG-2015');
INSERT INTO BORROW VALUES(121,3,'12-SEP-2015');

DESC BOOK;
DESC STUDENT;
DESC BORROW;

SELECT *FROM BOOK;
SELECT *FROM STUDENT;
SELECT *FROM BORROW;

SELECT STUDENT.NAME
FROM STUDENT,BOOK,BORROW
WHERE STUDENT.USN=BORROW.USN AND
BORROW.ISBN=BOOK.ISBN AND
BOOK.ISBN='123';

SELECT STUDENT.NAME
FROM STUDENT,BOOK,BORROW
WHERE STUDENT.USN=BORROW.USN AND
BORROW.ISBN=BOOK.ISBN AND
BOOK.TITLE='DATABASE';

SELECT STUDENT.NAME,COUNT(BOOK.ISBN)
FROM STUDENT,BOOK,BORROW
WHERE STUDENT.USN=BORROW.USN AND
BORROW.ISBN=BOOK.ISBN 
GROUP BY STUDENT.NAME;