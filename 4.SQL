DROP TABLE SHIPMENT;
DROP TABLE WAREHOUSE;
DROP TABLE PART;

CREATE TABLE PART (
PNO NUMBER(10) PRIMARY KEY,
PNAME VARCHAR(10) NOT NULL,
COLOUR VARCHAR(10) NOT NULL
);

INSERT INTO PART VALUES(1,'BOLTS','RED');
INSERT INTO PART VALUES(2,'FANS','RED');
INSERT INTO PART VALUES(3,'SCREWS','GREEN');

CREATE TABLE WAREHOUSE (
WNO NUMBER(10) PRIMARY KEY,
WNAME VARCHAR(10) NOT NULL,
CITY VARCHAR(20) NOT NULL
);

INSERT INTO WAREHOUSE VALUES(20,'OUT','MYSORE');
INSERT INTO WAREHOUSE VALUES(21,'NOOUT','BANGALORE');

CREATE TABLE SHIPMENT (
PNO NUMBER(10) NOT NULL,
WNO NUMBER(10) NOT NULL,
QUANTITY NUMBER(10) NOT NULL,
DAY DATE,
FOREIGN KEY (PNO) REFERENCES PART (PNO) ON DELETE CASCADE,
FOREIGN KEY (WNO) REFERENCES WAREHOUSE (WNO) ON DELETE CASCADE,
PRIMARY KEY(PNO,WNO)
);

INSERT INTO SHIPMENT VALUES(1,20,100,'13-JAN-2015');
INSERT INTO SHIPMENT VALUES(2,21,200,'13-SEP-2015');
INSERT INTO SHIPMENT VALUES(3,20,300,'13-MAR-2015');
INSERT INTO SHIPMENT VALUES(2,20,300,'13-JUL-2015');
INSERT INTO SHIPMENT VALUES(3,21,400,'13-MAY-2015');

DESC PART;
DESC WAREHOUSE;
DESC SHIPMENT;

SELECT *FROM PART;
SELECT *FROM WAREHOUSE;
SELECT *FROM SHIPMENT;

SELECT WAREHOUSE.WNAME
FROM WAREHOUSE,SHIPMENT,PART
WHERE WAREHOUSE.WNO=SHIPMENT.WNO AND
SHIPMENT.PNO=PART.PNO AND
PART.COLOUR='RED';

SELECT WAREHOUSE.WNAME,PART.PNO
FROM PART,WAREHOUSE,SHIPMENT
WHERE PART.PNO=SHIPMENT.PNO AND
SHIPMENT.WNO=WAREHOUSE.WNO;

SELECT WAREHOUSE.WNAME,COUNT(PART.PNO)
FROM WAREHOUSE,PART,SHIPMENT
WHERE WAREHOUSE.WNO=SHIPMENT.WNO AND
SHIPMENT.PNO=PART.PNO 
GROUP BY WAREHOUSE.WNAME;